{
    "id": "7bc5c778-e949-4435-b156-b00c4ede3e35",
    "name": "SCVMM",
    "friendlyName": "SCVMM",
    "description": "Manage Vms with SCVMM",
    "helpMarkDown": "[More Information](http://go.microsoft.com/fwlink/?LinkID=616089)",
    "category": "Deploy",
    "visibility": [
    "Build",
    "Release"
    ],
    "author": "Microsoft Corporation",
    "version": {
        "Major": 0,
        "Minor": 0,
        "Patch": 12
    },
    "demands": [
    "SCVMMAdminConsole"
    ],
    "minimumAgentVersion": "1.95.0",
    "inputs": [
    {
        "name": "ConnectedServiceName",
        "type": "connectedService:SCVMM",
        "label": "SCVMM Service Connection",
        "defaultValue": "",
        "required": true,
        "helpMarkDown": "SCVMM connection to configure before running any SCVMM operation"
    },
    {
        "name": "Action",
        "type": "pickList",
        "label": "Action",
        "defaultValue": "Restore",
        "required": true,
        "options": {            
            "CreateChekPoint": "Create Checkpoint",
            "DeleteChekPoint": "Delete Checkpoint",
            "NewVM": "New Virtual Machine using Template",
            "Restore": "Restore Checkpoint",
            "ExecutePS": "Run Powershell Script For SCVMM",
            "StartVM": "Start Virtual Machine",
            "StopVM": "Stop Virtual Machine"
        },
        "helpMarkDown": "Action to be performed on the SCVMM virtual machines."
    },
    {
        "name": "VMList",
        "type": "string",
        "label": "Virtual Machine Names",
        "defaultValue": "",
        "required": true,
        "visibleRule": "Action = CreateChekPoint || Action = DeleteChekPoint || Action = NewVM || Action = Restore || Action = StartVM || Action = StopVM",
        "helpMarkDown": "Provide a comma separated list of the virtual machine's names. For example, FabrikamWeb, FabrikamDB, FabrikamTest."
    },
    {
        "name": "VMTemplateName",
        "type": "string",
        "label": "Virtual Machine Template Name",
        "defaultValue": "",
        "required": true,
        "visibleRule": "Action = NewVM",
        "helpMarkDown": "Provide a Virtual Machine Template Name, using this template virtual machine will be created"
    }, 
    {
        "name": "CheckPointName",
        "type": "string",
        "label": "Checkpoint Name",
        "defaultValue": "",
        "required": true,
        "helpMarkDown": "Check point name",
        "visibleRule": "Action = Restore || Action = CreateChekPoint || Action = DeleteChekPoint"
    },
    {
        "name": "CheckPointDescription",
        "type": "string",
        "label": "Description For Checkpoint",
        "defaultValue": "",
        "required": false,
        "visibleRule": "Action = CreateChekPoint",
        "helpMarkDown": "Provide the Description for new checkPointName"
    },
    {
        "name": "ScopeFilter",
        "type": "pickList",
        "label": "Select VMs From",
        "required": false,
        "defaultValue": "None",
        "options": {
            "None": "None",
            "CloudFiltering": "Cloud",
            "HostFiltering": "Host"
        },
        "visibleRule": "Action = Restore || Action = CreateChekPoint || Action = DeleteChekPoint || Action = StopVM || Action = StartVM",
        "helpMarkDown": "Select the filter for Virtual Machine"
    },
    {
        "name": "ScopeFilterForNewVM",
        "type": "pickList",
        "label": "Deploy the VMs to",
        "required": false,
        "defaultValue": "HostFiltering",
        "options": {            
            "CloudFiltering": "Cloud",
            "HostFiltering": "Host"
        },
        "visibleRule": "Action = NewVM",
        "helpMarkDown": "Select the filter for Virtual Machine"
    },
    {
        "name": "CloudFilter",
        "type": "string",
        "label": "Cloud Name",
        "defaultValue": "",
        "required": true,
        "visibleRule": "ScopeFilter = CloudFiltering || ScopeFilterForNewVM = CloudFiltering",
        "helpMarkDown": "Cloud name to filter the VM"
    },
    {
        "name": "HostFilter",
        "type": "string",
        "label": "Host Name",
        "defaultValue": "",
        "required": true,
        "visibleRule": "ScopeFilter = HostFiltering || ScopeFilterForNewVM = HostFiltering",
        "helpMarkDown": "Host name to filter the VM"
    },
    {
        "name": "VMPath",
        "type": "string",
        "label": "Placement path for VM",
        "defaultValue": "",
        "required": false,
        "helpMarkDown": "Specify virtual machine path to be used during virtual machine placement. For example, path on the host machine - 'C:\\ProgramData\\Microsoft\\Windows\\Hyper-V'",
        "visibleRule": "ScopeFilterForNewVM = HostFiltering"
    },
    {
        "name": "NewVMAdditionalArgs",
        "type": "multiLine",
        "label": "Additional Arguments",
        "defaultValue": "-StartVM -StartAction NeverAutoTurnOnVM -StopAction SaveVM",
        "required": false,
        "properties": {
                "resizable": "true",
                "rows" : "5",
                "maxLength" : "500"
            },
        "helpMarkDown": "Specify the additional arguments for command to create new virtual machine using template",
        "visibleRule": "Action = NewVM"
    },    
    {
        "name": "ScriptPath",
        "type": "filePath",
        "label": "Script Path",
        "defaultValue": "",
        "required": true,
        "visibleRule": "Action = ExecutePS",
        "helpMarkDown": "Path of powershell script. Should be fully qualified path or relative to the default working directory."
    },
    {
        "name": "ScriptArguments",
        "type": "string",
        "label": "Script Arguments",
        "defaultValue": "",
        "required": false,
        "visibleRule": "Action = ExecutePS",
        "helpMarkDown": "Additional parameters to pass to PowerShell. Can be either ordinal or named parameters."
    },
    { 
        "name": "WorkingFolder", 
        "type": "filePath", 
        "label": "Working folder", 
        "defaultValue":"", 
        "required":false,
        "visibleRule": "Action = ExecutePS",
        "helpMarkDown": "Current working directory when script is run. Defaults to the folder where the script is located."
    },
    {
      "name": "WaitTimeToGetOSResponse",
      "type": "string",
      "label": "Wait Time",
      "defaultValue": "600",
      "required": false,
      "helpMarkDown": "Specify wait time in seconds for the Virtual Machine to be in ready state.",
      "visibleRule": "Action = StartVM || Action = Restore || Action = NewVM"
    },
    {
      "name": "computerNameFromTemplate",
      "type": "boolean",
      "label": "Set Computer name as defined in VM template",
      "defaultValue": "false",
      "visibleRule": "Action = NewVM",
      "required": false,
      "helpMarkDown": "If the checkbox is selected, computer name will be set as defined in the specified VM template. If not selected, Computer name will be same as that of the 'Virtual Machine Names'"
    }
    ],
    "instanceNameFormat": "SCVMM :$(Action) action on $(VMList)",
    "execution": {
        "PowerShell": {
            "target": "$(currentDirectory)\\scvmm.ps1",
            "argumentFormat": "",
            "workingDirectory": "$(currentDirectory)"
        }
    }
}
