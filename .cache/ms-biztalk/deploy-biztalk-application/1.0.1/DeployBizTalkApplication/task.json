{
    "id": "4c06323d-3802-4194-ae7b-1c249e76dd8f",
    "name": "BizTalkApplicationDeploy",
    "friendlyName": "BizTalk Server Application Deployment",
    "description": "Create or Update the BizTalk Server Application",
    "helpMarkDown": "[More Information](https://aka.ms/biztalkalm)",
    "category": "Deploy",
    "author": "Microsoft BizTalk Server",
    "runsOn" : [
         "Agent"
     ],
    "version": {
        "Major": 1,
        "Minor": 0,
        "Patch": 0
    },
    "demands" : [],
    "instanceNameFormat": "Deploy BizTalk Server Application : $(applicationName)",
    "groups": [
        {
             "name": "BizTalkApplicationDetails", 
             "displayName": "BizTalk Application Details", 
             "isExpanded": true 
         },
         {
             "name": "BizTalkApplicationAdvanceOptions", 
             "displayName": "Advanced Options", 
             "isExpanded": false 
         }
    ],
    "inputs": [
        {
            "name": "operationName",
            "type": "pickList",
            "label": "Operation Name",
            "defaultValue": "CreateApplication",
            "groupName": "BizTalkApplicationDetails",
            "required": true,
            "helpMarkDown": "Actions to be performed on the BizTalk Application deployment.",
            "options": {
                "CreateApplication": "Create new BizTalk Server Application",
                "UpdateApplication": "Update an existing BizTalk Server Application"
            }
        },
        {
            "name": "applicationName",
            "type": "string",
            "label": "Application Name",
            "groupName": "BizTalkApplicationDetails",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Provide the name of BizTalk Server Application."
        },
        {
            "name": "packagePath",
            "type": "filePath",
            "groupName": "BizTalkApplicationDetails",
            "label": "Deployment package path",
            "defaultValue": "",
            "helpMarkDown": "Specify the path of BizTalk Application package in zip format.",
            "required": true
        },
        {
            "name": "applicationReferences",
            "type": "multiLine",
            "groupName": "BizTalkApplicationAdvanceOptions",
            "label": "Add Application References",
            "defaultValue": "",
            "helpMarkDown": "Specify the list of referenced applications",
            "required": false,
            "properties": {
                "resizable": "true",
                "rows": "3",
                "maxLength": "500"
            }
        }
    ],
    "execution": {
        "PowerShell3": {
            "target": "Start-Deployment.ps1"
        }
    },
    "messages": {       
        "StartedMethodExecution": "{0} : Started execution",
        "CompletedMethodExecution": "{0} : Completed execution",
        "ProcessorArchitecture": "Processor Architecture is 64 Bit",
        "BizTalkRegistryPath": "BizTalk Registry Path: '{0}'",
        "BizTalkInstalled": "BizTalk is Installed.",
        "BizTalkNotInstalled": "BizTalk is not installed",
        "BizTalkInstallationDirectory": "Biztalk installation directoy: {0}",
        "BizTalkDirectoryAccessFailed": "Can not access BizTalk directory : {0}",
        "BTSTASKInstall": "BTSTaskExe Exist",
        "DataBaseName": "DataBase Name: {0}",
        "ManagementDBServer": "Management DB Server Name : {0}",
        "SQLServerConnectionString": "SQL Server Connection string : {0}",
        "AssemblyExist": "Assembly exist : {0}",
        "AssemblyNotExist": "Assembly does not exist : {0}",
        "DeveloperToolPathExist": "Developer tools path exist : {0}",
        "DeveloperToolPathNotExist": "Developer tools path does not exist.",
        "LoadingAssembly": "Loading Assembly : {0}",
        "BizTalkApplicationExist": "{0} - Biztalk Application exist: {1}",
        "BizTalkApplicationNotExist": "{0} - Biztalk Application does not exist: {1}",
        "ReferencedBizTalkApplicationNotExist": "Referenced Biztalk Application : '{0}' does not exist while Creating New Application : '{1}'",
        "AddApplicationReference": "Adding Reference to Biztalk Application : '{0}' in New Application : '{1}'",
        "CreatingApplication": "{0} - Creating New Application : {1}",
        "ApplicationVersion": "{0} - Application Version : {1}",
        "ApplicationCreated": "Application Created Successfully : {0}",
        "RemovingApplication": "{0} - Removing BizTalk Application : {1}",
        "ApplicationRemoved": "BizTalk Application Removed : {0}",
        "StartingApplication": "{0} - Starting BizTalk Application : {1}",
        "ApplicationStarted": "Application Started Successfully : {0}",
        "StoppingApplication": "{0} - Stopping BizTalk Application : {1}",
        "ApplicationStopped": "Application Stopped Successfully : {0}",
        "ApplicationNotExist": "Application does not Exist : {0}",
        "ImportingBizTalkBinding": "{0} - Importing Binding for BizTalk Application : {1}",
        "ImportedBizTalkBinding": "Binding Imported Successfully for BizTalk Application : {0}",
        "ImportingBizTalkAssembly": "{0} - Importing Assembly for BizTalk Application : {1}",
        "ImportedBizTalkAssembly": "Assembly Imported Successfully for BizTalk Application : {0}",
        "ImportedBizTalkAssemblyDestination": "Assembly Imported Successfully for BizTalk Application : {0} in the Destination Path : {1}",
        "ExportingBizTalkApplication": "{0} - Exporting BizTalk Application into MSI. Application Name : {1}",
        "ExportedBizTalkApplication": "Export Successful for BizTalk Application : {0}",
        "CopyToDestinationFailed": "Cannot copy to '{0}' because it would overwrite an existing file, and 'Force' was not specified.",
        "DestinationAlreadyExist": "Cannot expand package because the destination path specifies a file that already exists '{0}'",
        "DestinationExistNoForce": "Cannot expand package because the destination '{0}' already exists, and 'Force' was not specified.",
        "ExpandPackage": "Expand package '{0}' into directory '{1}'.",
        "TokenFound": "Discovered {0} unique tokens within the bindings files: {1}.",
        "ReadingToken": "Reading token from VSTS.",
        "EmptyEnvironmentVariable": "Null or Empty Value received for Environment Variable: '{0}'. Please Provide a valid value.",
        "QueryVSTSForToken": "Query VSTS for token values.",
        "InjectToken": "Inject tokens into '{0}'.",
        "NoTokenReplaced": "No tokens found/replaced in file '{0}'.",
        "NoChangeinTokenFile": "Not altering existing copy of original, tokenized file '{0}'.",
        "PreserveOriginalTokenFile": "Preserve original, tokenized file as '{0}'.",
        "DetokenizedLine": "Detokenized line '{0}' to '{1}'.",
        "DeploymentBegin": "Begin deployment sequence of: {0}.",
        "DeploymentEnd": "End of deployment sequence",
        "InventoryNotFound": "Inventory file not found at '{0}'; the application package may not be valid.",
        "ReadingInventory": "Read inventory file '{0}'.",
        "BindingFileNotExist": "Binding file specified by inventory does not exist: '{0}'.",
        "BindingFileFound": "Found {0} existing bindings file(s) specified by inventory.",
        "NoDeploymentReference": "In the inventory file, DeploymentSequence reference '{0}' does not refer to any items within the BizTalkAssemblies nor BindingsFiles sections.",
        "DeploymentIgnored": "In the inventory file, DeploymentSequence reference '{0}' will be ignored becauase it refers to more than one item within the BizTalkAssemblies and BindingsFiles sections.",
        "NoItemFoundtoDeploy": "Found no items to deploy specified by the inventory file.",
        "DeploymentItemFound": "Found '{0}' items to deploy specified by the inventory file.",
        "InventoryPropertyFound": "Found '{0}' of '{1}' specified by inventory.",
        "InventoryPropertyNotFound": "A valid value for $descriptor was not found in inventory.",
        "SystemArtifactDirNotFound": "The working directory for the Visual Studio agent is not known because the environment variable 'SYSTEM_ARTIFACTSDIRECTORY' does not exist; consequently, this working directory will be used: '{0}'.",
        "QueryVSTSForInput": "Query VSTS for primary input parameters.",
        "RequiredParameterNotFound": "Unable to acquire one or more required input parameters from the VSTS task.",
        "UnrecognizedOperation": "Unrecognized operationName value '{0}'.",
        "BeginPackageInstallationtoUpdateApplication": "Begin installation of '{0}' to update BizTalk Application '{0}'.",
        "FinishedUpdateApplication": "Finished update to application '{0}' normally.",
        "BeginPackageInstallationtoOverWriteApplication": "Begin installation of '{0}' to overwrite BizTalk Application '{0}'.",
        "FinishedOverWriteApplication": "Finished OverWrite of application '{0}' normally."
    }
}