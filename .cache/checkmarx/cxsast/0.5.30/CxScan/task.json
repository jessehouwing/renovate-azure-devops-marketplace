{
  "id": "5262FEE4-B921-4E23-9D22-3BCCAA562688",
  "name": "Security static source code analysis",
  "friendlyName": "Checkmarx",
  "description": "Security static source code analysis",
  "helpMarkDown": "[Information] https://checkmarx.atlassian.net/wiki/display/KC/CxSAST+MS-VSTS+Plugin",
  "category": "Build",
  "visibility": [
    "Build"
  ],
  "author": "Ilan Dayan",
  "version": {
    "Major": 1,
    "Minor": 0,
    "Patch": 0
  },
  "demands": [
  ],
  "minimumAgentVersion": "1.0.0",
  "groups": [
    {
      "name": "serverSettings",
      "displayName": "Checkmarx Server",
      "isExpanded": true
    },
    {
      "name": "scanSettings",
      "displayName": "Checkmarx Scan",
      "isExpanded": true
    }
  ],
  "instanceNameFormat": "Security static source code analysis",
  "inputs": [
    {
      "name": "CheckmarxService",
      "type": "connectedService:Checkmarx-Endpoint",
      "label": "Checkmarx Endpoint",
      "required": true,
      "helpMarkDown": "The CX server endpoint.",
      "groupName": "serverSettings"
    },
    {
      "name": "projectName",
      "type": "string",
      "label": "Project Name",
      "required": true,
      "helpMarkDown": "Either select an existing project name or type a name to create a new scan project",
      "groupName": "serverSettings"
    },
    {
      "name": "preset",
      "type": "pickList",
      "label": "Preset",
      "required": true,
      "groupName": "serverSettings",
      "defaultValue": "Default",
      "helpMarkDown": "predefined sets of queries that you can select when Creating, Configuring and Branching Projects. Predefined presets are provided by Checkmarx and you can configure your own. You can also import and export presets (on the server).",
      "options": {
        "Default 2014": "Default 2014",
        "Default": "Default",
        "XS": "XS",
        "JSSEC": "JSSEC",
        "Apple Secure Coding Guide": "Apple Secure Coding Guide",
        "WordPress": "WordPress",
        "OWASP TOP 10 - 2013": "OWASP TOP 10 - 2013",
        "Mobile": "Mobile",
        "High and Medium and Low": "High and Medium and Low",
        "HIPAA": "HIPAA",
        "MISRA_CPP": "MISRA_CPP",
        "MISRA_C": "MISRA_C",
        "Android": "Android",
        "SANS top 25": "SANS top 25",
        "Empty preset": "Empty preset",
        "PCI": "PCI",
        "OWASP TOP 10 - 2010": "OWASP TOP 10 - 2010",
        "High and Medium": "High and Medium",
        "Error handling": "Error handling",
        "All": "All"
      }
    },
    {
      "name": "fullTeamName",
      "type": "string",
      "label": "Team",
      "required": true,
      "helpMarkDown": "The full team name (for example, CxServer\\SP\\Company\\Users).",
      "groupName": "serverSettings"
    },
    {
      "name": "incScan",
      "type": "boolean",
      "label": "Incremental Scan",
      "required": true,
      "defaultValue": "true",
      "helpMarkDown": "Set true for incremental scan. If no scan was done yet, the scan will be a full scan and the following ones will be incremental.",
      "groupName": "scanSettings"
    },
    {
      "name": "folderExclusion",
      "type": "string",
      "label": "Folder Exclusion",
      "required": false,
      "helpMarkDown": "Comma delineated list of the folders to exclude from the scan (for example: dto,target,WEB-INF)",
      "groupName": "scanSettings"
    },
    {
      "name": "fileExtension",
      "type": "string",
      "label": "File Extension",
      "required": false,
      "helpMarkDown": "Comma delineated list of the file extensions to exclude from the scan (for example: *.log,*.txt,*.xml)",
      "groupName": "scanSettings"
    },
    {
      "name": "syncMode",
      "type": "boolean",
      "label": "Synchronous Mode",
      "required": false,
      "defaultValue": "true",
      "helpMarkDown": "Enabling this option will cause the build step to wait for scan results, you can see the scan results inside the Checkmarx plug-in results window. If disabled, the results are only displayed inside the Checkmarx web-application",
      "groupName": "scanSettings"
    },
    {
      "name": "vulnerabilityThreshold",
      "type": "boolean",
      "label": "Vulnerability Threshold Level:",
      "required": false,
      "defaultValue": "true",
      "helpMarkDown": "Available only if Synchronous mode is enabled. Set the maximum number of vulnerabilities of given severity before the scan fails.",
      "groupName": "scanSettings",
      "visibleRule": "syncMode = true"
    },
    {
      "name": "high",
      "type": "string",
      "label": "High",
      "required": false,
      "helpMarkDown": "",
      "groupName": "scanSettings",
      "visibleRule": "vulnerabilityThreshold = true"
    },
    {
      "name": "medium",
      "type": "string",
      "label": "Medium",
      "required": false,
      "helpMarkDown": "",
      "groupName": "scanSettings",
      "visibleRule": "vulnerabilityThreshold = true"
    },
    {
      "name": "low",
      "type": "string",
      "label": "Low",
      "required": false,
      "helpMarkDown": "",
      "groupName": "scanSettings",
      "visibleRule": "vulnerabilityThreshold = true"
    }
  ],
  "execution": {
    "PowerShell": {
      "target": "$(currentDirectory)\\CxVSTS.ps1",
      "argumentFormat": "",
      "workingDirectory": "$(currentDirectory)"
    }
  },
  "messages": {
  }
}